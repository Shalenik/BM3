% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit.R
\name{fit_bfact_model}
\alias{fit_bfact_model}
\title{Fit BFACT Model for a Single H Value}
\usage{
fit_bfact_model(sim, H, nsim = 10000, iseed = 123)
}
\arguments{
\item{sim}{A list containing:
\itemize{
\item Y: matrix of climate model outputs (n_time × K)
\item z: vector of observations (n_time)
\item years: vector of years
}}

\item{H}{Integer. Number of latent factors to fit.}

\item{nsim}{Integer. Number of MCMC iterations (default 10000).}

\item{iseed}{Integer. Random seed for reproducibility.}
}
\value{
A list containing:
\itemize{
\item H: fitted H value
\item posterior: list with samples for beta, U, phi, sigma2
\item metrics: list with RMSE and other diagnostics
\item settings: list of input parameters
}
}
\description{
Fits a Bayesian Flexible Adaptation to Climate Trends (BFACT) latent factor model to data.
This is the core fitting function that runs MCMC to estimate posterior
distributions of latent factors and model weights.
}
\details{
The BFACT model represents observations as:
z_t = mu + U \%*\% beta_t + epsilon_t

where U is a basis matrix (n_time × H), beta_t are time-varying weights,
and epsilon_t is Gaussian error.
}
\examples{
\dontrun{
sim <- simulate_data(H_true = 2, K = 20)
fit <- fit_bfact_model(sim, H = 2, nsim = 5000)
}

}
