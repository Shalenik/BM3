[{"path":"https://shalenik.github.io/BM3/articles/01-fit-real-data.html","id":"fitting-bfact-to-real-climate-data","dir":"Articles","previous_headings":"","what":"Fitting BFACT to Real Climate Data","title":"Fitting BFACT to Real Climate Data","text":"vignette demonstrates complete workflow fitting BFACT model real climate data, using New York temperature anomalies example.","code":""},{"path":"https://shalenik.github.io/BM3/articles/01-fit-real-data.html","id":"introduction","dir":"Articles","previous_headings":"Fitting BFACT to Real Climate Data","what":"Introduction","title":"Fitting BFACT to Real Climate Data","text":"BFACT package includes real climate data : - Climate Models: Temperature anomalies CMIP6 models 3 SSP scenarios (1850-2100) - Observations: HadCRUT5 annual temperature anomalies (1850-2022) - Location: New York region, summer (JJA) seasonal averages vignette demonstrates model fitting smaller scale.","code":""},{"path":"https://shalenik.github.io/BM3/articles/01-fit-real-data.html","id":"load-real-climate-data","dir":"Articles","previous_headings":"Fitting BFACT to Real Climate Data","what":"Load Real Climate Data","title":"Fitting BFACT to Real Climate Data","text":"","code":"library(BFACT) library(ncdf4) library(patchwork)  # Load NetCDF file containing New York temperature anomalies nc_file <- system.file(\"data\", \"NewYork_temperature_anomalies_JJA_all_models_1961-1990baseline.nc\", package = \"BFACT\") nc_data <- nc_open(nc_file)  # Extract temperature data: dimensions are [lon, lat, year, scenario, model] temp_data <- ncvar_get(nc_data, \"temperature\") years <- ncvar_get(nc_data, \"year\") models <- ncvar_get(nc_data, \"model\") # Spatially average across lon and lat for each year, scenario, and model # Result: [year, scenario, model] = [251, 3, 19] temp_avg <- apply(temp_data, c(3, 4, 5), mean, na.rm = TRUE)  # Extract data for each SSP scenario # Scenarios: 1=SSP1-2.6, 2=SSP2-4.5, 3=SSP5-8.5 climate_models <- list(     z126c = temp_avg[, 1, ],     z245c = temp_avg[, 2, ],     z585c = temp_avg[, 3, ] )  # Add model names as column names for (i in seq_along(climate_models)) {     colnames(climate_models[[i]]) <- models }  # Observations are available for years 1-173 (1850-2022) hadcrut_file <- system.file(\"data\", \"hadcrut5_annual.rds\", package = \"BFACT\") hadcrut5_annual <- readRDS(hadcrut_file)  nc_close(nc_data)  # Data summary cat(\"Climate model dimensions:\", dim(climate_models$z126c), \"\\n\") ## Climate model dimensions: 251 19 cat(\"HadCRUT5 observations:\", length(hadcrut5_annual), \"years\\n\") ## HadCRUT5 observations: 173 years"},{"path":"https://shalenik.github.io/BM3/articles/01-fit-real-data.html","id":"visualize-data","dir":"Articles","previous_headings":"Fitting BFACT to Real Climate Data","what":"Visualize Data","title":"Fitting BFACT to Real Climate Data","text":"Plot climate models observations see ’re working :","code":"par(mfrow = c(3, 1), mar = c(4, 4, 2, 1)) scenarios <- c(\"z126c\", \"z245c\", \"z585c\") titles <- c(\"SSP 1-2.6\", \"SSP 2-4.5\", \"SSP 5-8.5\")  for (i in seq_along(scenarios)) {     mat <- climate_models[[scenarios[i]]]     matplot(1:nrow(mat), mat,         type = \"l\", lty = 1, col = \"gray70\",         xlab = \"Year\", ylab = \"Temperature Anomaly\", main = titles[i],         ylim = range(c(mat, hadcrut5_annual), na.rm = TRUE)     )     # Add HadCRUT5 observations as red line for overlapping years     n_hadcrut <- length(hadcrut5_annual)     lines(1:n_hadcrut, hadcrut5_annual, col = \"red\", lwd = 2)     legend(\"topright\",         legend = c(\"Climate Models\", \"HadCRUT5 Observations\"),         col = c(\"gray70\", \"red\"), lty = c(1, 1), cex = 0.8, bty = \"n\"     ) }"},{"path":"https://shalenik.github.io/BM3/articles/01-fit-real-data.html","id":"prune-data-for-model-fitting","dir":"Articles","previous_headings":"Fitting BFACT to Real Climate Data","what":"Prune Data for Model Fitting","title":"Fitting BFACT to Real Climate Data","text":"two climate models clear outliers scenarios. apply outlier detection method identify remove models fitting BFACT model. step performed indpendently scenario.","code":"# Apply outlier detection to each scenario and prune pruned_climate_models <- list() outlier_models <- list()  for (i in seq_along(scenarios)) {     mat <- climate_models[[scenarios[i]]]     outlier_models[[scenarios[i]]] <- BFACT::detect_outliers(         data = mat,         start_index = 1,         end_index = nrow(mat),         threshold_fn = BFACT::mean_sd_threshold,         threshold_dial = 2.5     )     pruned_climate_models[[scenarios[i]]] <- mat[, !colnames(mat) %in% outlier_models[[scenarios[i]]], drop = FALSE] }  cat(\"Outliers by scenario:\\n\") ## Outliers by scenario: print(outlier_models) ## $z126c ## [1] \"CIESM\"       \"UKESM1-0-LL\" ##  ## $z245c ## [1] \"CIESM\"       \"UKESM1-0-LL\" ##  ## $z585c ## [1] \"CIESM\"       \"UKESM1-0-LL\" # Use pruned data for downstream fitting climate_models <- pruned_climate_models  for (i in seq_along(scenarios)) {     mat <- climate_models[[scenarios[i]]]     matplot(1:nrow(mat), mat,         type = \"l\", lty = 1, col = \"gray70\",         xlab = \"Year\", ylab = \"Temperature Anomaly\", main = titles[i],         ylim = range(c(mat, hadcrut5_annual), na.rm = TRUE)     )     # Add HadCRUT5 observations as red line for overlapping years     n_hadcrut <- length(hadcrut5_annual)     lines(1:n_hadcrut, hadcrut5_annual, col = \"red\", lwd = 2)     legend(\"topright\",         legend = c(\"Climate Models\", \"HadCRUT5 Observations\"),         col = c(\"gray70\", \"red\"), lty = c(1, 1), cex = 0.8, bty = \"n\"     ) }"},{"path":"https://shalenik.github.io/BM3/articles/01-fit-real-data.html","id":"fit-bfact-models","dir":"Articles","previous_headings":"Fitting BFACT to Real Climate Data","what":"Fit BFACT Models","title":"Fitting BFACT to Real Climate Data","text":"Fit BFACT model SSP scenario. demonstration uses 100 MCMC iterations speed; full analysis paper uses 10000 iterations. fit just H=2 simplicity. nsim: Number MCMC iterations (100 speed, 10000 paper) J: Burnin iterations H: Basis functions (2-7 full analysis) fit H=2 100 iterations takes ~1-2 seconds","code":"# Fit BFACT for each SSP scenario # Note: Using reduced parameters for demonstration # Paper uses: H=2:7, nsim=10000 results <- list()  for (i in seq_along(scenarios)) {     cat(sprintf(\"\\n=== Fitting %s ===\\n\", titles[i]))      fit <- BFACT(         Y = climate_models[[scenarios[i]]],         z = hadcrut5_annual,         T = 251, # Total time points         T1 = 1, # Start of climate model data         T2 = 173, # End of observation data         H = 2, # Basis dimension (paper fits 2:7)         iseed = 123 + i, # Different seed for each scenario         J = 6, # Burnin iterations         nsim = 100 # MCMC iterations (paper uses 10000)     )     results[[scenarios[i]]] <- fit      cat(sprintf(\"Completed fit for %s\\n\", titles[i])) } ##  ## === Fitting SSP 1-2.6 === ## Completed fit for SSP 1-2.6 ##  ## === Fitting SSP 2-4.5 === ## Completed fit for SSP 2-4.5 ##  ## === Fitting SSP 5-8.5 === ## Completed fit for SSP 5-8.5"},{"path":"https://shalenik.github.io/BM3/articles/01-fit-real-data.html","id":"visualize-posterior-results","dir":"Articles","previous_headings":"Fitting BFACT to Real Climate Data","what":"Visualize Posterior Results","title":"Fitting BFACT to Real Climate Data","text":"Plot posterior samples observations models:","code":"# Generate plots for each scenario plots <- list()  for (i in seq_along(scenarios)) {     # Get posterior samples     fit <- results[[scenarios[i]]]     burn_start <- ceiling(nrow(fit$beta_samples) / 2)      # Compute posterior means for each sample     post_samples <- sample_posterior(fit)      # Create plot using the new function     plots[[i]] <- plot_data_with_posterior(         Y = climate_models[[scenarios[i]]],         z = hadcrut5_annual,         posterior_samples = post_samples,         title = titles[i],         years = 1:251,         obs_years = 1:173     ) }  # Combine plots with patchwork combined_plot <- plots[[1]] / plots[[2]] / plots[[3]] print(combined_plot)"},{"path":"https://shalenik.github.io/BM3/articles/02-posterior-simulation.html","id":"generate-posterior-simulations","dir":"Articles","previous_headings":"","what":"Generate Posterior Simulations","title":"Generate Posterior Simulations","text":"vignette shows generate synthetic climate data fitted posteriors, fit BFACT evaluate model misspecification.","code":""},{"path":"https://shalenik.github.io/BM3/articles/02-posterior-simulation.html","id":"overview","dir":"Articles","previous_headings":"Generate Posterior Simulations","what":"Overview","title":"Generate Posterior Simulations","text":"Workflow: 1. Extract posterior samples fitted model (e.g., H_true=2) 2. Generate synthetic observations posterior draws 3. Fit BFACT multiple H values (1-20) synthetic data 4. Compare fitted H vs true H assess model misspecification","code":""},{"path":"https://shalenik.github.io/BM3/articles/02-posterior-simulation.html","id":"step-1-fit-real-data-and-extract-posterior-samples","dir":"Articles","previous_headings":"Generate Posterior Simulations","what":"Step 1: Fit Real Data and Extract Posterior Samples","title":"Generate Posterior Simulations","text":"Start fitting BFACT real New York temperature data, extract posterior draws. H0=2H_0 = 2.","code":"devtools::load_all() library(BFACT) library(ncdf4)  # Load real climate data (same as vignette 01) nc_file <- system.file(\"data\", \"NewYork_temperature_anomalies_JJA_all_models_1961-1990baseline.nc\", package = \"BFACT\") nc <- nc_open(nc_file)  temp_data <- ncvar_get(nc, \"temperature\") years <- ncvar_get(nc, \"year\") models <- ncvar_get(nc, \"model\") temp_avg <- apply(temp_data, c(3, 4, 5), mean, na.rm = TRUE)  # Use SSP 5-8.5 (highest warming scenario) Y_real <- temp_avg[, 3, ]  # Add model names as column names - this is necessary for outlier detection and later analysis colnames(Y_real) <- models  # Remove outlier models outliers <- BFACT::detect_outliers(     data = Y_real,     start_index = 1,     end_index = nrow(Y_real),     threshold_fn = BFACT::mean_sd_threshold,     threshold_dial = 2.5 ) if (length(outliers) > 0) {     cat(\"Removed outlier models:\", paste(outliers, collapse = \", \"), \"\\n\")     Y_real <- Y_real[, !colnames(Y_real) %in% outliers, drop = FALSE] }  hadcrut_file <- system.file(\"data\", \"hadcrut5_annual.rds\", package = \"BFACT\") z_real <- readRDS(hadcrut_file)  nc_close(nc)  # Fit BFACT to real data with H=2 cat(\"Fitting BFACT to real data (H=2)...\\n\") fit_real <- BFACT(     Y = Y_real,     z = z_real,     T = 251,     T1 = 1,     T2 = 173,     H = 2,     iseed = 123,     J = 6,     nsim = 100 # Demonstration scale )  # Generate synthetic data from this posterior draw sim_posterior <- simulate_from_posterior(     fit = fit_real,     years_start = 1850,     years_end = 2100,     T1 = 1,     T2 = 173,     J = 6,     OBS_COL = 1,     seed = 123 )  cat(\"Real data fit complete. Generated synthetic observations from H0=2 posterior.\\n\")  # Plot simulated data with true trend p_sim <- plot_data_with_posterior(     Y = sim_posterior$Y,     z = sim_posterior$z,     true_trend = sim_posterior$mu[, 1],     title = \"Synthetic Data: Generated from H0=2 Posterior\",     years = sim_posterior$years,     obs_years = sim_posterior$T1:sim_posterior$T2 ) print(p_sim)"},{"path":"https://shalenik.github.io/BM3/articles/02-posterior-simulation.html","id":"step-2-fit-multiple-h-values-to-synthetic-data","dir":"Articles","previous_headings":"Generate Posterior Simulations","what":"Step 2: Fit Multiple H Values to Synthetic Data","title":"Generate Posterior Simulations","text":"Now fit BFACT H∈2,…,5H \\2,\\ldots,5 evaluate model sensitivity:","code":"# Fit H=2 to H=5 to the synthetic data H_fit_range <- 2:5 fits_posterior <- list()  for (H in H_fit_range) {     cat(sprintf(\"\\nFitting H=%d to synthetic data from H=2 posterior...\\n\", H))      fit <- BFACT(         Y = sim_posterior$Y,         z = sim_posterior$z,         T = 251,         T1 = 1,         T2 = 173,         H = H,         iseed = 123 + H,         J = 6,         nsim = 100 # Demonstration scale     )      fits_posterior[[as.character(H)]] <- fit }  cat(\"Completed fits for H=2:5\\n\")"},{"path":"https://shalenik.github.io/BM3/articles/02-posterior-simulation.html","id":"plotting-posterior-fits","dir":"Articles","previous_headings":"Generate Posterior Simulations > Step 2: Fit Multiple H Values to Synthetic Data","what":"Plotting Posterior Fits","title":"Generate Posterior Simulations","text":"","code":"library(patchwork)  # Generate posterior fit plots for each H plots_H <- list()  for (H in H_fit_range) {     fit <- fits_posterior[[as.character(H)]]          plots_H[[as.character(H)]] <- plot_data_with_posterior(         Y = sim_posterior$Y,         z = sim_posterior$z,         posterior_samples = sample_posterior(fit),         title = sprintf(\"H = %d\", H),         years = sim_posterior$years,         obs_years = sim_posterior$T1:sim_posterior$T2     ) }  # Combine plots in grid grid_plot <- plots_H[[1]] / plots_H[[2]] / plots_H[[3]] / plots_H[[4]] print(grid_plot)"},{"path":"https://shalenik.github.io/BM3/articles/02-posterior-simulation.html","id":"step-3-model-sensitivity-to-h","dir":"Articles","previous_headings":"Generate Posterior Simulations","what":"Step 3: Model Sensitivity to H","title":"Generate Posterior Simulations","text":"Compute RMSE H value assess.","code":"out <- consolidate_results(fits_posterior, sim_posterior)  cat(\"\\nModel comparison (RMSE on synthetic data):\\n\") print(out$model_comparison)  # Find best H using RMSE best_H <- out$model_comparison$H[which.min(out$model_comparison$RMSE)] cat(sprintf(\"\\nBest H by RMSE: %d\\n\", best_H)) cat(sprintf(\"True H: %d\\n\", sim_posterior$H_true))"},{"path":"https://shalenik.github.io/BM3/articles/03-multiple-replicates.html","id":"model-selection-across-multiple-replications","dir":"Articles","previous_headings":"","what":"Model Selection Across Multiple Replications","title":"Model Selection Across Multiple Replications","text":"vignette demonstrates assess model selection performance (finding true H) across multiple independent replications data. key demonstration BFACT paper: showing method can reliably identify true number latent factors across different random realizations.","code":""},{"path":"https://shalenik.github.io/BM3/articles/03-multiple-replicates.html","id":"overview","dir":"Articles","previous_headings":"Model Selection Across Multiple Replications","what":"Overview","title":"Model Selection Across Multiple Replications","text":": 1. Generate synthetic data known true H value 2. Create 3 independent replications 3. Fit BFACT H=2 - H=4 replicate 4. Aggregate results across replications using consolidate_results() 5. Show summary statistics model selection","code":""},{"path":"https://shalenik.github.io/BM3/articles/03-multiple-replicates.html","id":"step-1-load-package-and-data","dir":"Articles","previous_headings":"Model Selection Across Multiple Replications","what":"Step 1: Load Package and Data","title":"Model Selection Across Multiple Replications","text":"","code":"library(BFACT) library(ggplot2) library(dplyr) ##  ## Attaching package: 'dplyr' ## The following objects are masked from 'package:stats': ##  ##     filter, lag ## The following objects are masked from 'package:base': ##  ##     intersect, setdiff, setequal, union library(ncdf4) library(patchwork)"},{"path":"https://shalenik.github.io/BM3/articles/03-multiple-replicates.html","id":"step-2-generate-multiple-replications","dir":"Articles","previous_headings":"Model Selection Across Multiple Replications","what":"Step 2: Generate Multiple Replications","title":"Model Selection Across Multiple Replications","text":"’ll generate 5 replications synthetic data true H=2 model, using different random seeds:","code":"# Generate synthetic data from real posterior nc_file <- system.file(\"data\", \"NewYork_temperature_anomalies_JJA_all_models_1961-1990baseline.nc\", package = \"BFACT\") nc <- nc_open(nc_file) temp_data <- ncvar_get(nc, \"temperature\") years <- ncvar_get(nc, \"year\") models <- ncvar_get(nc, \"model\") temp_avg <- apply(temp_data, c(3, 4, 5), mean, na.rm = TRUE) Y_real <- temp_avg[, 3, ] colnames(Y_real) <- models  # Remove outlier models outliers <- BFACT::detect_outliers(     data = Y_real,     start_index = 1,     end_index = nrow(Y_real),     threshold_fn = BFACT::mean_sd_threshold,     threshold_dial = 2.5 ) if (length(outliers) > 0) {     cat(\"Removed outlier models:\", paste(outliers, collapse = \", \"), \"\\n\")     Y_real <- Y_real[, !colnames(Y_real) %in% outliers, drop = FALSE] } ## Removed outlier models: CIESM, UKESM1-0-LL climate_models <- list(z585c = Y_real) hadcrut_file <- system.file(\"data\", \"hadcrut5_annual.rds\", package = \"BFACT\") hadcrut5_annual <- readRDS(hadcrut_file) nc_close(nc)  # Fit to real data to get a posterior draw cat(\"Fitting BFACT to real data to generate posterior...\\n\") ## Fitting BFACT to real data to generate posterior... fit_real <- BFACT(     Y = climate_models$z585c,     z = hadcrut5_annual,     T = nrow(climate_models$z585c),     T1 = 1,     T2 = length(hadcrut5_annual),     H = 2,     iseed = 999,     J = 6,     nsim = 100 )  # Generate 3 replications from the posterior n_reps <- 3 sims_list <- list() for (rep in 1:n_reps) {     cat(sprintf(\"Generating replicate %d/%d...\\n\", rep, n_reps))     sim_rep <- simulate_from_posterior(         fit_real,         s = NULL, # Random sample from second half of chain         seed = 1000 + rep     )     sims_list[[rep]] <- sim_rep } ## Generating replicate 1/3... ## Generating replicate 2/3... ## Generating replicate 3/3... cat(sprintf(\"Generated %d replications with H_true = 2\\n\", n_reps)) ## Generated 3 replications with H_true = 2"},{"path":"https://shalenik.github.io/BM3/articles/03-multiple-replicates.html","id":"step-3-fit-bfact-with-multiple-h-values-to-each-replicate","dir":"Articles","previous_headings":"Model Selection Across Multiple Replications","what":"Step 3: Fit BFACT with Multiple H Values to Each Replicate","title":"Model Selection Across Multiple Replications","text":"Now fit H=2, H=3, H=4 replicate:","code":"H_values <- 2:4 fits_list <- list()  for (rep in 1:n_reps) {     cat(sprintf(\"\\n=== Replicate %d/%d ===\\n\", rep, n_reps))     sim_rep <- sims_list[[rep]]     fits_rep <- list()      for (H in H_values) {         cat(sprintf(\"  Fitting H=%d...\\n\", H))         fit <- BFACT(             Y = sim_rep$Y,             z = sim_rep$z,             T = sim_rep$T,             T1 = sim_rep$T1,             T2 = sim_rep$T2,             H = H,             iseed = 2000 + rep * 100 + H,             J = 6,             nsim = 50         )         fits_rep[[as.character(H)]] <- fit     }     fits_list[[rep]] <- fits_rep } ##  ## === Replicate 1/3 === ##   Fitting H=2... ##   Fitting H=3... ##   Fitting H=4... ##  ## === Replicate 2/3 === ##   Fitting H=2... ##   Fitting H=3... ##   Fitting H=4... ##  ## === Replicate 3/3 === ##   Fitting H=2... ##   Fitting H=3... ##   Fitting H=4... cat(\"\\nCompleted all fits!\\n\") ##  ## Completed all fits!"},{"path":"https://shalenik.github.io/BM3/articles/03-multiple-replicates.html","id":"step-4-consolidate-results-across-replications","dir":"Articles","previous_headings":"Model Selection Across Multiple Replications","what":"Step 4: Consolidate Results Across Replications","title":"Model Selection Across Multiple Replications","text":"Use consolidate_results() aggregate across replications:","code":"results_multi <- consolidate_results(     fits = fits_list,     sim = sims_list,     by_replicate = TRUE ) ## Consolidating 3 replicates with multiple H fits... ## Consolidating 3 fit(s)... ## Consolidating 3 fit(s)... ## Consolidating 3 fit(s)... ## Consolidating 3 fit(s)... ## Consolidating 3 fit(s)... ## Consolidating 3 fit(s)... ##   Replicate comparison (aggregated across all replicates): ## # A tibble: 3 × 8 ##       H mean_RMSE sd_RMSE min_RMSE max_RMSE n_reps mean_post_var max_post_var ##   <int>     <dbl>   <dbl>    <dbl>    <dbl>  <int>         <dbl>        <dbl> ## 1     2     0.292  0.0463    0.241    0.331      3        0.0290       0.0683 ## 2     4     0.308  0.0520    0.262    0.364      3        0.0124       0.0157 ## 3     3     0.468  0.268     0.289    0.776      3        0.0565       0.148 # View the replicate comparison table cat(\"\\n=== Model Selection Summary Across Replications ===\\n\") ##  ## === Model Selection Summary Across Replications === print(results_multi$replicate_comparison) ## # A tibble: 3 × 8 ##       H mean_RMSE sd_RMSE min_RMSE max_RMSE n_reps mean_post_var max_post_var ##   <int>     <dbl>   <dbl>    <dbl>    <dbl>  <int>         <dbl>        <dbl> ## 1     2     0.292  0.0463    0.241    0.331      3        0.0290       0.0683 ## 2     4     0.308  0.0520    0.262    0.364      3        0.0124       0.0157 ## 3     3     0.468  0.268     0.289    0.776      3        0.0565       0.148"},{"path":"https://shalenik.github.io/BM3/articles/03-multiple-replicates.html","id":"step-5-identify-the-elbow-point","dir":"Articles","previous_headings":"Model Selection Across Multiple Replications","what":"Step 5: Identify the Elbow Point","title":"Model Selection Across Multiple Replications","text":"Use elbow method identify optimal H value performance plateaus:","code":"# Extract H values and mean RMSE H_vals <- results_multi$replicate_comparison$H rmse_vals <- results_multi$replicate_comparison$mean_RMSE  # Find the elbow elbow_H <- find_elbow(H_vals, rmse_vals, minimize = TRUE)  cat(sprintf(\"\\nElbow point identified at H = %d\\n\", elbow_H)) ##  ## Elbow point identified at H = 2 cat(sprintf(     \"Mean RMSE at H=%d: %.4f\\n\", elbow_H,     results_multi$replicate_comparison$mean_RMSE[         results_multi$replicate_comparison$H == elbow_H     ] )) ## Mean RMSE at H=2: 0.2924"},{"path":"https://shalenik.github.io/BM3/articles/03-multiple-replicates.html","id":"step-6-visualize-model-selection-performance-with-elbow","dir":"Articles","previous_headings":"Model Selection Across Multiple Replications","what":"Step 6: Visualize Model Selection Performance with Elbow","title":"Model Selection Across Multiple Replications","text":"Plot RMSE H across replications elbow point marked:","code":"p_avg <- plot_replicate_averages(results_multi, sims_list) p_norm <- plot_normalized_metrics(     results_multi$replicate_comparison,     title = \"Normalized RMSE and Posterior Variance Metrics (with Elbow Detection)\" ) p_var <- plot_posterior_variance(results_multi)  combined_plot <- p_avg | p_norm | p_var print(combined_plot)"},{"path":"https://shalenik.github.io/BM3/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Shaleni Kovach. Author, maintainer.","code":""},{"path":"https://shalenik.github.io/BM3/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kovach S (2026). BFACT: Package (Title Case). R package version 0.1.0, https://shalenik.github.io/BM3/.","code":"@Manual{,   title = {BFACT: What the Package Does (Title Case)},   author = {Shaleni Kovach},   year = {2026},   note = {R package version 0.1.0},   url = {https://shalenik.github.io/BM3/}, }"},{"path":"https://shalenik.github.io/BM3/index.html","id":"bfact","dir":"","previous_headings":"","what":"What the Package Does (Title Case)","title":"What the Package Does (Title Case)","text":"Bayesian Factor Analysis Climate Trends (BFACT) R package modeling climate data using Bayesian methods latent factor structures.","code":""},{"path":"https://shalenik.github.io/BM3/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"What the Package Does (Title Case)","text":"can install development version BFACT GitHub:","code":"# install.packages(\"devtools\") devtools::install_github(\"Shalenik/BM3\")"},{"path":"https://shalenik.github.io/BM3/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"What the Package Does (Title Case)","text":"Bayesian Factor Analysis: Fit BFACT models climate data customizable latent factors Model Selection: Tools selecting optimal model complexity using elbow detection Outlier Detection: Robust methods identifying removing outlier climate models Visualization: Comprehensive plotting functions results diagnostics Posterior Simulation: Generate analyze posterior samples","code":""},{"path":"https://shalenik.github.io/BM3/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting Started","title":"What the Package Does (Title Case)","text":"See vignettes detailed examples: Fitting BFACT Real Climate Data - Learn fit BFACT model real temperature anomaly data Generate Posterior Simulations - Work posterior samples synthetic data generation Model Selection Across Multiple Replications - Evaluate model selection consistency across replications","code":""},{"path":"https://shalenik.github.io/BM3/index.html","id":"quick-example","dir":"","previous_headings":"","what":"Quick Example","title":"What the Package Does (Title Case)","text":"","code":"library(BFACT)  # Simulate data with H_true = 2 latent factors sim <- simulate_data(H_true = 2, K = 20, T_obs = 50)  # Fit BFACT model with H = 2 fit <- fit_bfact_model(sim, H = 2, nsim = 5000)  # Extract posterior mean curve post_mean <- posterior_mean_curve(fit)  # Plot results plot_data_with_posterior(sim$Y, sim$z,                          posterior_samples = sample_posterior(fit, ncurves = 50),                         title = \"BFACT Fit\")"},{"path":"https://shalenik.github.io/BM3/index.html","id":"main-functions","dir":"","previous_headings":"","what":"Main Functions","title":"What the Package Does (Title Case)","text":"BFACT() - Core Bayesian factor analysis function fit_bfact_model() - Convenient wrapper model fitting consolidate_results() - Aggregate results across multiple H values find_elbow() - Identify optimal model complexity detect_outliers() - Remove outlier climate models simulate_data() - Generate synthetic data testing","code":""},{"path":"https://shalenik.github.io/BM3/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"What the Package Does (Title Case)","text":"use BFACT research, please cite:","code":"[Citation information to be added]"},{"path":"https://shalenik.github.io/BM3/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"What the Package Does (Title Case)","text":"[License information added]","code":""},{"path":"https://shalenik.github.io/BM3/reference/BFACT.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian Latent Factor Model for Climate Projections (BFACT) — BFACT","title":"Bayesian Latent Factor Model for Climate Projections (BFACT) — BFACT","text":"Runs Gibbs sampler estimate latent factor trajectories U, spline coefficients gamma, loadings beta, observation/model precisions phiep, factor precisions phiet.","code":""},{"path":"https://shalenik.github.io/BM3/reference/BFACT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian Latent Factor Model for Climate Projections (BFACT) — BFACT","text":"","code":"BFACT(   Y,   z,   T,   T1,   T2,   H,   iseed,   J,   nsim,   mga = 0.1,   mbe = 0.1,   aep = 0.1,   bep = 0.1,   aet = 0.1,   bet = 0.1,   a1 = 3,   a2 = 3 )"},{"path":"https://shalenik.github.io/BM3/reference/BFACT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian Latent Factor Model for Climate Projections (BFACT) — BFACT","text":"Y Numeric matrix T x m model outputs (column model series). z Numeric vector observed anomalies years T1:T2. T Integer total number time points. T1, T2 Integers giving observation window indices (1 ≤ T1 ≤ T2 ≤ T). H Integer number latent factors. iseed Integer RNG seed reproducibility. J Integer number spline basis functions (natural splines via splines::ns). nsim Integer number posterior draws. mga Prior precision (ridge) spline coefficients gamma. Default 0.1. mbe Prior precision (ridge) loadings beta. Default 0.1. aep Gamma shape observation/model precisions phiep. Default 0.1. bep Gamma rate  observation/model precisions phiep. Default 0.1. aet Gamma shape factor precisions phiet. Default 0.1. bet Gamma rate  factor precisions phiet. Default 0.1. a1 Gamma shape shrinkage delta_1. Default 3. a2 Gamma shape shrinkage delta_>=2. Default 3.","code":""},{"path":"https://shalenik.github.io/BM3/reference/BFACT.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian Latent Factor Model for Climate Projections (BFACT) — BFACT","text":"list elements: X, ysim, U_samples, beta_samples, gamma_samples","code":""},{"path":"https://shalenik.github.io/BM3/reference/consolidate_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Consolidate Fitting Results — consolidate_results","title":"Consolidate Fitting Results — consolidate_results","text":"Create summary statistics fitted BFACT models across multiple H values. Combines individual fit objects posterior summaries model comparison metrics.","code":""},{"path":"https://shalenik.github.io/BM3/reference/consolidate_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Consolidate Fitting Results — consolidate_results","text":"","code":"consolidate_results(fits, sim, by_replicate = FALSE)"},{"path":"https://shalenik.github.io/BM3/reference/consolidate_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Consolidate Fitting Results — consolidate_results","text":"fits List fit objects (output fit_bfact_model()), list lists multiple replications. See details. sim List containing simulation data (Y, z, years), list lists multiple replications. by_replicate Logical. TRUE, compute per-replicate statistics (default FALSE). fits sim lists lists, aggregate across replications.","code":""},{"path":"https://shalenik.github.io/BM3/reference/consolidate_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Consolidate Fitting Results — consolidate_results","text":"list containing: timewise_summaries: tibble posterior means/CIs per H model_comparison: tibble comparing metrics across H values per_replicate_stats: per-replicate RMSE by_replicate=TRUE replicate_comparison: tibble mean/sd RMSE H across replications (multiple reps)","code":""},{"path":"https://shalenik.github.io/BM3/reference/consolidate_results.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Consolidate Fitting Results — consolidate_results","text":"Consolidates multiple H fits single summary table columns: H_fit: fitted H value time: time index post_mean: posterior mean prediction post_ci_lower, post_ci_upper: 95% credible interval se: squared error time point rmse: overall RMSE H multiple replications, pass: fits: list lists, inner list fits one replicate sim: list simulation lists, one per replicate","code":""},{"path":"https://shalenik.github.io/BM3/reference/consolidate_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Consolidate Fitting Results — consolidate_results","text":"","code":"if (FALSE) { # \\dontrun{ sim <- simulate_data(H_true = 2, K = 20) fit_H2 <- fit_bfact_model(sim, H = 2) fit_H3 <- fit_bfact_model(sim, H = 3)  results <- consolidate_results(     fits = list(fit_H2, fit_H3),     sim = sim ) head(results$timewise_summaries) } # }"},{"path":"https://shalenik.github.io/BM3/reference/detect_outliers.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect Outlier Climate Models Using RMSE Thresholding — detect_outliers","title":"Detect Outlier Climate Models Using RMSE Thresholding — detect_outliers","text":"Iteratively removes climate model columns whose RMSE ensemble mean exceeds user-defined threshold. Assumes input matrix data frame time series rows models columns.","code":""},{"path":"https://shalenik.github.io/BM3/reference/detect_outliers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect Outlier Climate Models Using RMSE Thresholding — detect_outliers","text":"","code":"detect_outliers(   data,   start_index,   end_index,   threshold_fn = mean_sd_threshold,   threshold_dial = 2.5 )"},{"path":"https://shalenik.github.io/BM3/reference/detect_outliers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect Outlier Climate Models Using RMSE Thresholding — detect_outliers","text":"data numeric matrix data frame model outputs. start_index Integer, starting row index (e.g., corresponding 2015). end_index Integer, ending row index (e.g., corresponding 2100). threshold_fn function taking numeric vector RMSE values returning RMSE threshold. Default mean_sd_threshold(). threshold_dial Numeric multiplier passed threshold_fn. Default 2.5.","code":""},{"path":"https://shalenik.github.io/BM3/reference/detect_outliers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect Outlier Climate Models Using RMSE Thresholding — detect_outliers","text":"character vector column names identified outliers.","code":""},{"path":"https://shalenik.github.io/BM3/reference/find_elbow.html","id":null,"dir":"Reference","previous_headings":"","what":"Find Elbow Point in a Curve (Perpendicular Distance Method) — find_elbow","title":"Find Elbow Point in a Curve (Perpendicular Distance Method) — find_elbow","text":"Identifies \"elbow\" point metric-vs-H curve using perpendicular distance method. Useful model selection fitting multiple H values (e.g., identifying optimal H finding RMSE variance improvements plateau).","code":""},{"path":"https://shalenik.github.io/BM3/reference/find_elbow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find Elbow Point in a Curve (Perpendicular Distance Method) — find_elbow","text":"","code":"find_elbow(x, y, minimize = TRUE)"},{"path":"https://shalenik.github.io/BM3/reference/find_elbow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find Elbow Point in a Curve (Perpendicular Distance Method) — find_elbow","text":"x Numeric vector x-values (typically H values). y Numeric vector y-values (typically RMSE variance). minimize Logical. TRUE (default), assumes lower y better (e.g., RMSE). FALSE, assumes higher y better (e.g., likelihood).","code":""},{"path":"https://shalenik.github.io/BM3/reference/find_elbow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find Elbow Point in a Curve (Perpendicular Distance Method) — find_elbow","text":"Numeric. x-value (H) identified elbow point.","code":""},{"path":"https://shalenik.github.io/BM3/reference/find_elbow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find Elbow Point in a Curve (Perpendicular Distance Method) — find_elbow","text":"elbow method finds curve transitions steep flat. algorithm: Identifies decreasing region curve Normalizes x y 0,1 scale Draws line start end decreasing region Calculates perpendicular distance point line Returns x-value (H) maximum perpendicular distance particularly useful model selection optimal H unclear metric alone.","code":""},{"path":"https://shalenik.github.io/BM3/reference/find_elbow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find Elbow Point in a Curve (Perpendicular Distance Method) — find_elbow","text":"","code":"if (FALSE) { # \\dontrun{ # Find elbow in RMSE curve H_values <- 2:7 rmse_values <- c(0.85, 0.42, 0.38, 0.36, 0.35, 0.35) elbow_h <- find_elbow(H_values, rmse_values, minimize = TRUE) print(elbow_h) # Likely returns H around 3-4 } # }"},{"path":"https://shalenik.github.io/BM3/reference/fit_bfact_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit BFACT Model for a Single H Value — fit_bfact_model","title":"Fit BFACT Model for a Single H Value — fit_bfact_model","text":"Fits Bayesian Flexible Adaptation Climate Trends (BFACT) latent factor model data. core fitting function runs MCMC estimate posterior distributions latent factors model weights.","code":""},{"path":"https://shalenik.github.io/BM3/reference/fit_bfact_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit BFACT Model for a Single H Value — fit_bfact_model","text":"","code":"fit_bfact_model(sim, H, nsim = 10000, iseed = 123)"},{"path":"https://shalenik.github.io/BM3/reference/fit_bfact_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit BFACT Model for a Single H Value — fit_bfact_model","text":"sim list containing: Y: matrix climate model outputs (n_time × K) z: vector observations (n_time) years: vector years H Integer. Number latent factors fit. nsim Integer. Number MCMC iterations (default 10000). iseed Integer. Random seed reproducibility.","code":""},{"path":"https://shalenik.github.io/BM3/reference/fit_bfact_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit BFACT Model for a Single H Value — fit_bfact_model","text":"list containing: H: fitted H value posterior: list samples beta, U, phi, sigma2 metrics: list RMSE diagnostics settings: list input parameters","code":""},{"path":"https://shalenik.github.io/BM3/reference/fit_bfact_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit BFACT Model for a Single H Value — fit_bfact_model","text":"BFACT model represents observations : z_t = mu + U %*% beta_t + epsilon_t U basis matrix (n_time × H), beta_t time-varying weights, epsilon_t Gaussian error.","code":""},{"path":"https://shalenik.github.io/BM3/reference/fit_bfact_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit BFACT Model for a Single H Value — fit_bfact_model","text":"","code":"if (FALSE) { # \\dontrun{ sim <- simulate_data(H_true = 2, K = 20) fit <- fit_bfact_model(sim, H = 2, nsim = 5000) } # }"},{"path":"https://shalenik.github.io/BM3/reference/mean_sd_threshold.html","id":null,"dir":"Reference","previous_headings":"","what":"RMSE Threshold Function (Mean + k SD) — mean_sd_threshold","title":"RMSE Threshold Function (Mean + k SD) — mean_sd_threshold","text":"Computes threshold outlier detection mean plus dial standard deviations.","code":""},{"path":"https://shalenik.github.io/BM3/reference/mean_sd_threshold.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RMSE Threshold Function (Mean + k SD) — mean_sd_threshold","text":"","code":"mean_sd_threshold(rmse_vals, dial = 2.5)"},{"path":"https://shalenik.github.io/BM3/reference/mean_sd_threshold.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RMSE Threshold Function (Mean + k SD) — mean_sd_threshold","text":"rmse_vals numeric vector RMSE values. dial Numeric multiplier standard deviation. Default 2.5.","code":""},{"path":"https://shalenik.github.io/BM3/reference/mean_sd_threshold.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RMSE Threshold Function (Mean + k SD) — mean_sd_threshold","text":"numeric threshold value.","code":""},{"path":"https://shalenik.github.io/BM3/reference/mvrnorm_fast.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast multivariate normal sampling — mvrnorm_fast","title":"Fast multivariate normal sampling — mvrnorm_fast","text":"Fast multivariate normal sampling","code":""},{"path":"https://shalenik.github.io/BM3/reference/mvrnorm_fast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast multivariate normal sampling — mvrnorm_fast","text":"","code":"mvrnorm_fast(n, mu, sigma)"},{"path":"https://shalenik.github.io/BM3/reference/plot_comparison.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Model Comparison — plot_comparison","title":"Plot Model Comparison — plot_comparison","text":"Create plot comparing model performance across H values.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_comparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Model Comparison — plot_comparison","text":"","code":"plot_comparison(results, title = NULL)"},{"path":"https://shalenik.github.io/BM3/reference/plot_comparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Model Comparison — plot_comparison","text":"results List consolidate_results(). title Optional plot title (default NULL).","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_comparison.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Model Comparison — plot_comparison","text":"ggplot2 object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_data_with_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Data with Posterior Samples or True Trend — plot_data_with_posterior","title":"Plot Data with Posterior Samples or True Trend — plot_data_with_posterior","text":"Create plot climate models observations either posterior samples true trend.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_data_with_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Data with Posterior Samples or True Trend — plot_data_with_posterior","text":"","code":"plot_data_with_posterior(   Y,   z,   posterior_samples = NULL,   true_trend = NULL,   title = NULL,   years = NULL,   obs_years = 1:length(z) )"},{"path":"https://shalenik.github.io/BM3/reference/plot_data_with_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Data with Posterior Samples or True Trend — plot_data_with_posterior","text":"Y Matrix climate model outputs (time x models). z Vector observations. posterior_samples Optional matrix posterior samples (samples x time). true_trend Optional vector true trend (e.g., mu simulation). title Optional plot title (default NULL). years Optional vector years x-axis (default: 1:nrow(Y)). obs_years Indices observations available (default: 1:length(z)).","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_data_with_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Data with Posterior Samples or True Trend — plot_data_with_posterior","text":"ggplot2 object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_data_with_posterior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Data with Posterior Samples or True Trend — plot_data_with_posterior","text":"","code":"if (FALSE) { # \\dontrun{ # With posterior samples p <- plot_data_with_posterior(Y, z, posterior_samples, title = \"Real Data Fit\")  # With true trend p <- plot_data_with_posterior(Y, z, true_trend = mu, title = \"Synthetic Data\") } # }"},{"path":"https://shalenik.github.io/BM3/reference/plot_normalized_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Normalized Metrics with Elbow Detection — plot_normalized_metrics","title":"Plot Normalized Metrics with Elbow Detection — plot_normalized_metrics","text":"Creates overlay plot RMSE, mean posterior variance, max posterior variance, normalized 0,1 scale error bars. Displays elbow points metric.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_normalized_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Normalized Metrics with Elbow Detection — plot_normalized_metrics","text":"","code":"plot_normalized_metrics(model_comparison, title = NULL, show_legend = TRUE)"},{"path":"https://shalenik.github.io/BM3/reference/plot_normalized_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Normalized Metrics with Elbow Detection — plot_normalized_metrics","text":"model_comparison Tibble columns: H, RMSE, mean_post_var, max_post_var (typically consolidate_results()$replicate_comparison). title Optional plot title (default NULL). show_legend Logical. Whether display legend (default: TRUE).","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_normalized_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Normalized Metrics with Elbow Detection — plot_normalized_metrics","text":"ggplot2 object showing normalized metrics overlaid elbows marked vertical lines.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_normalized_metrics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Normalized Metrics with Elbow Detection — plot_normalized_metrics","text":"function: Normalizes three metrics 0,1 scale Computes standard errors available (sd columns) Identifies elbow points metric independently Displays metrics lines error bars Marks elbows colored vertical dotted lines: Blue: RMSE elbow Green: Mean posterior variance elbow Orange: Max posterior variance elbow","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_normalized_metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Normalized Metrics with Elbow Detection — plot_normalized_metrics","text":"","code":"if (FALSE) { # \\dontrun{ results <- consolidate_results(fits, sims, by_replicate = TRUE) p <- plot_normalized_metrics(results$replicate_comparison) print(p) } # }"},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Posterior Distribution — plot_posterior","title":"Plot Posterior Distribution — plot_posterior","text":"Create plot posterior means credible intervals.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Posterior Distribution — plot_posterior","text":"","code":"plot_posterior(results, H, data = NULL, title = NULL)"},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Posterior Distribution — plot_posterior","text":"results List consolidate_results(). H Integer. H value plot. data Optional. Observations overlay (default NULL). title Optional plot title (default NULL).","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Posterior Distribution — plot_posterior","text":"ggplot2 object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Posterior Distribution — plot_posterior","text":"","code":"if (FALSE) { # \\dontrun{ plot_posterior(results, H = 2, title = \"My Title\") } # }"},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior_variance.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Variance of Posterior Means Across Replicates — plot_posterior_variance","title":"Plot Variance of Posterior Means Across Replicates — plot_posterior_variance","text":"Creates plot showing variance posterior means across replicates changes H. Lower variance indicates consistent predictions.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior_variance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Variance of Posterior Means Across Replicates — plot_posterior_variance","text":"","code":"plot_posterior_variance(results_multi, title = NULL)"},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior_variance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Variance of Posterior Means Across Replicates — plot_posterior_variance","text":"results_multi List consolidate_results() by_replicate=TRUE. title Optional plot title (default NULL).","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior_variance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Variance of Posterior Means Across Replicates — plot_posterior_variance","text":"ggplot2 object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior_variance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Variance of Posterior Means Across Replicates — plot_posterior_variance","text":"H value, computes variance posterior means across replicates time point, averages variances time. Lower variance indicates fitted H produces consistent predictions across different random realizations data.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_posterior_variance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Variance of Posterior Means Across Replicates — plot_posterior_variance","text":"","code":"if (FALSE) { # \\dontrun{ results <- consolidate_results(fits_list, sims_list, by_replicate = TRUE) p <- plot_posterior_variance(results) print(p) } # }"},{"path":"https://shalenik.github.io/BM3/reference/plot_replicate_averages.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Average Posterior Means Across Replicates with True Trend — plot_replicate_averages","title":"Plot Average Posterior Means Across Replicates with True Trend — plot_replicate_averages","text":"Creates plot showing average posterior mean fitted H value across multiple replications, overlaid true trend (mu) simulated data.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_replicate_averages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Average Posterior Means Across Replicates with True Trend — plot_replicate_averages","text":"","code":"plot_replicate_averages(results_multi, sims_list, title = NULL)"},{"path":"https://shalenik.github.io/BM3/reference/plot_replicate_averages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Average Posterior Means Across Replicates with True Trend — plot_replicate_averages","text":"results_multi List consolidate_results() by_replicate=TRUE. sims_list List simulation objects (one per replicate), containing Y, z, mu, years. title Optional plot title (default NULL).","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_replicate_averages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Average Posterior Means Across Replicates with True Trend — plot_replicate_averages","text":"ggplot2 object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_replicate_averages.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Average Posterior Means Across Replicates with True Trend — plot_replicate_averages","text":"function: Computes average posterior mean H across replicates Plots averages colored lines Overlays true trend (mu) red line Shows averaged Y (climate models) replicate grey lines","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_replicate_averages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Average Posterior Means Across Replicates with True Trend — plot_replicate_averages","text":"","code":"if (FALSE) { # \\dontrun{ results <- consolidate_results(fits_list, sims_list, by_replicate = TRUE) p <- plot_replicate_averages(results, sims_list) print(p) } # }"},{"path":"https://shalenik.github.io/BM3/reference/plot_timewise.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Timewise Posterior with Observations — plot_timewise","title":"Plot Timewise Posterior with Observations — plot_timewise","text":"Plot posterior predictions observed data overlaid.","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_timewise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Timewise Posterior with Observations — plot_timewise","text":"","code":"plot_timewise(results, sim, title = NULL)"},{"path":"https://shalenik.github.io/BM3/reference/plot_timewise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Timewise Posterior with Observations — plot_timewise","text":"results List consolidate_results(). sim Simulation data list years z (observations). title Optional plot title (default NULL).","code":""},{"path":"https://shalenik.github.io/BM3/reference/plot_timewise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Timewise Posterior with Observations — plot_timewise","text":"ggplot2 object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/posterior_mean_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Posterior Mean Curve — posterior_mean_curve","title":"Compute Posterior Mean Curve — posterior_mean_curve","text":"Returns posterior mean curve BFACT object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/posterior_mean_curve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Posterior Mean Curve — posterior_mean_curve","text":"","code":"posterior_mean_curve(BFACT)"},{"path":"https://shalenik.github.io/BM3/reference/posterior_mean_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Posterior Mean Curve — posterior_mean_curve","text":"BFACT BFACT object $ysim element.","code":""},{"path":"https://shalenik.github.io/BM3/reference/posterior_mean_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Posterior Mean Curve — posterior_mean_curve","text":"Numeric vector posterior means.","code":""},{"path":"https://shalenik.github.io/BM3/reference/sample_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampled Posterior Curves — sample_posterior","title":"Sampled Posterior Curves — sample_posterior","text":"Returns sample posterior curves BFACT object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/sample_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampled Posterior Curves — sample_posterior","text":"","code":"sample_posterior(BFACT, ncurves = NULL)"},{"path":"https://shalenik.github.io/BM3/reference/sample_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampled Posterior Curves — sample_posterior","text":"BFACT BFACT object $ysim element.","code":""},{"path":"https://shalenik.github.io/BM3/reference/sample_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampled Posterior Curves — sample_posterior","text":"Numeric matrix posterior curves.","code":""},{"path":"https://shalenik.github.io/BM3/reference/simulate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Climate Data — simulate_data","title":"Simulate Climate Data — simulate_data","text":"Generate synthetic climate model outputs observations testing. Creates latent factor model H latent factors, K climate models, realistic temporal structure.","code":""},{"path":"https://shalenik.github.io/BM3/reference/simulate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Climate Data — simulate_data","text":"","code":"simulate_data(   H_true = 2,   K = 20,   years_start = 1850,   years_end = 2100,   obs_end = 2022,   seed = NULL )"},{"path":"https://shalenik.github.io/BM3/reference/simulate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Climate Data — simulate_data","text":"H_true Integer. True number latent factors. K Integer. Number climate models (default 20). years_start Integer. Start year (default 1850). years_end Integer. End year (default 2100). obs_end Integer. Last year observations (default 2022). seed Integer. Random seed reproducibility.","code":""},{"path":"https://shalenik.github.io/BM3/reference/simulate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Climate Data — simulate_data","text":"list containing: Y: matrix climate model outputs (n_time × K) z: vector observations (n_time) years: vector years y_obs_full: full observations including future K: number models H_true: true H value","code":""},{"path":"https://shalenik.github.io/BM3/reference/simulate_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate Climate Data — simulate_data","text":"generative model: Y_kt ~ N(mu_k + U %% beta_k(t), tau2_k) z_t ~ N(mu + U %% beta(t), sigma2) U basis matrix (n_time × H) smooth temporal patterns.","code":""},{"path":"https://shalenik.github.io/BM3/reference/simulate_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Climate Data — simulate_data","text":"","code":"if (FALSE) { # \\dontrun{ sim <- simulate_data(H_true = 2, K = 20, seed = 123) dim(sim$Y) # [1] 251 20 (years 1850-2100) length(sim$z) # [1] 173 (years 1850-2022) } # }"},{"path":"https://shalenik.github.io/BM3/reference/simulate_from_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Data from a Posterior Draw of a Fitted BFACT Object — simulate_from_posterior","title":"Simulate Data from a Posterior Draw of a Fitted BFACT Object — simulate_from_posterior","text":"Generates simulated dataset single posterior draw fitted BFACT object.","code":""},{"path":"https://shalenik.github.io/BM3/reference/simulate_from_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Data from a Posterior Draw of a Fitted BFACT Object — simulate_from_posterior","text":"","code":"simulate_from_posterior(   fit,   s = NULL,   years_start = 1850,   years_end = 2100,   T2 = 173,   T1 = 1,   J = 6,   OBS_COL = 1,   seed = NULL )"},{"path":"https://shalenik.github.io/BM3/reference/simulate_from_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Data from a Posterior Draw of a Fitted BFACT Object — simulate_from_posterior","text":"fit fitted BFACT object (returned BFACT()). s Integer index posterior draw use (default: random draw). years_start First year (default: 1850). years_end Last year (default: 2100). T2 Last observed time index (default: 173). T1 First observed time index (default: 1). J Number spline basis functions (default: 6). OBS_COL column Y observed series (default: 1). seed Random seed reproducibility (default: NULL).","code":""},{"path":"https://shalenik.github.io/BM3/reference/simulate_from_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Data from a Posterior Draw of a Fitted BFACT Object — simulate_from_posterior","text":"list simulated data metadata.","code":""}]
